<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KnaveTone ⚡ | Your Cart</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Poppins:wght@300;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-dark text-light">

  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="index.html">KnaveTone ⚡</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto align-items-center" id="navAuthLinks"></ul>
      </div>
    </div>
  </nav>

  <div class="container py-3">
    <button onclick="window.history.back()" class="btn btn-sm btn-outline-info mb-3 d-flex align-items-center">
      <i class="bi bi-arrow-left me-2"></i> Go Back
    </button>
    
    <nav aria-label="breadcrumb">
  <ol id="breadcrumb"></ol>
</nav>
  </div>

  <section class="container py-5">
    <h1 class="text-warning mb-4 display-4 font-orbitron">Your Shopping Cart</h1>

    <div class="row">
      <div class="col-lg-8">
        <div id="cartItemsList" class="list-group list-group-flush mb-4"></div>

        <div id="emptyCartMessage" class="alert alert-cyber alert-info text-center p-4 d-none">
          <i class="bi bi-bag-x me-2"></i> Your cart is empty.
          <a href="product.html" class="alert-link text-warning ms-2">Start shopping now!</a>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card card-cyber">
          <div class="card-body">
            <h5 class="card-title text-info mb-4">Order Summary</h5>
            <ul class="list-unstyled">
              <li class="d-flex justify-content-between mb-2">
                <span>Subtotal:</span>
                <span id="cartSubtotal">$0.00</span>
              </li>
              <li class="d-flex justify-content-between mb-2 border-bottom border-secondary pb-2">
                <span>Tax (7%):</span>
                <span id="cartTax">$0.00</span>
              </li>
              <li class="d-flex justify-content-between fw-bold fs-5 mt-3">
                <span class="text-warning">Total:</span>
                <span id="cartTotal" class="text-warning">$0.00</span>
              </li>
            </ul>
            <button id="checkoutBtn" class="btn btn-warning fw-bold w-100 mt-4" disabled>
              <i class="bi bi-credit-card me-2"></i> Proceed to Checkout
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Login Modal (optional content) -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true"></div>

  <!-- Alert Modal -->
  <div class="modal fade" id="customAlertModal" tabindex="-1" aria-labelledby="customAlertTitle" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="customAlertTitle">Alert</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p id="customAlertBody"></p>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-cyber-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ✅ Confirm Remove Modal -->
<div class="modal fade" id="confirmRemoveModal" tabindex="-1" aria-labelledby="confirmRemoveTitle" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header border-0">
        <h5 class="modal-title text-danger" id="confirmRemoveTitle">Remove Item</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p id="confirmRemoveBody">Are you sure?</p>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger btn-sm" id="confirmRemoveBtn">Remove</button>
      </div>
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Global constants and utilities are defined here
    //const API_BASE_URL = "http://localhost:5000";
    const API_BASE_URL = "https://mongodb-crud-api-azs9.onrender.com";
    const DEFAULT_PROFILE_PIC = "/uploads/default.png";
    
    // API Endpoints
    const PRODUCTS_URL = `${API_BASE_URL}/api/products`;
    const USERS_URL = `${API_BASE_URL}/api/users`;
    const PROFILE_URL = `${USERS_URL}/profile`;
    const LOGIN_URL = `${USERS_URL}/login`;
    const REGISTER_URL = `${USERS_URL}`;

    // Alert modal helper
    const customAlertModal = new bootstrap.Modal(document.getElementById('customAlertModal'));
    window.showAlert = function(message, type) {
      const titleEl = document.getElementById('customAlertTitle');
      const bodyEl = document.getElementById('customAlertBody');
      
      titleEl.textContent = type === 'success' ? 'Success' : type === 'danger' ? 'Error' : 'Alert';
      titleEl.classList.remove('text-info', 'text-warning', 'text-danger');
      titleEl.classList.add(type === 'success' ? 'text-warning' : type === 'danger' ? 'text-danger' : 'text-info');
      
      bodyEl.textContent = message;
      customAlertModal.show();
    }

    // ✅ Confirm remove helper (returns a Promise<boolean>)
    const confirmRemoveModal = new bootstrap.Modal(document.getElementById('confirmRemoveModal'));
  const confirmRemoveBody  = document.getElementById('confirmRemoveBody');
  const confirmRemoveBtn   = document.getElementById('confirmRemoveBtn');

  // Returns a Promise<boolean> that resolves true if user confirms, false otherwise
  window.showConfirmRemove = function(message) {
    return new Promise((resolve) => {
      if (!confirmRemoveModal || !confirmRemoveBody || !confirmRemoveBtn) {
        // Fallback to browser confirm if elements are missing
        const ok = confirm(message);
        resolve(ok);
        return;
      }

      confirmRemoveBody.textContent = message;

      // Remove any old click handler by assigning a new one
      confirmRemoveBtn.onclick = () => {
        confirmRemoveModal.hide();
        resolve(true);
      };

      // If user closes modal by X / backdrop -> cancel
      const modalEl = document.getElementById('confirmRemoveModal');
      const handler = () => {
        modalEl.removeEventListener('hidden.bs.modal', handler);
        resolve(false);
      };
      modalEl.addEventListener('hidden.bs.modal', handler, { once: true });

      confirmRemoveModal.show();
    });
  };
</script>

  <script src="index.js"></script>

   <script>
    window.BREADCRUMB = [
      { label: 'Home', href: 'index.html' },
      { label: 'Products', href: 'product.html' },   // remove this line if you want only Home > Cart
      { label: 'Your Cart', href: null }
    ];
  </script>
  <script src="breadcrumb.js"></script>

  <script src="cart.js"></script>
</body>
</html>